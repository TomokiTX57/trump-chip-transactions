<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒªãƒ³ã‚°ãƒãƒƒãƒ—ç®¡ç†</title>
</head>
<body>
  <h1>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ¤œç´¢</h1>
  <input type="text" id="query" placeholder="åå‰ã¾ãŸã¯ID">
  <button onclick="searchPlayer()">æ¤œç´¢</button>

  <div id="result"></div>

  <hr>

  <h1>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ–°è¦ç™»éŒ²</h1>
  <input type="text" id="name" placeholder="åå‰"><br>
  <input type="text" id="memo" placeholder="ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰"><br>
  <button onclick="registerPlayer()">ç™»éŒ²</button>

  <div id="registerResult"></div>

  <script>
    // âœ… GASã®å…±é€šURLï¼ˆGETã‚‚POSTã‚‚ã“ã®URLï¼‰
    const GAS_URL = "https://script.google.com/macros/s/AKfycbz59BPpvZvrm8Fc3GTDbgY4m4alCRDs0tO7eWBOy3zdn3ZlxbZhTMxbLiM-bccsxHAOFA/exec";

    // ğŸ” ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ¤œç´¢ï¼ˆGETï¼‰
    async function searchPlayer() {
      const query = document.getElementById("query").value;
      const url = `${GAS_URL}?action=getPlayer&query=${encodeURIComponent(query)}`;

      try {
        const res = await fetch(url);
        const data = await res.json();

        const resultDiv = document.getElementById("result");

        if (data && data.player_id) {
          resultDiv.innerHTML = `
            <p><strong>ID:</strong> ${data.player_id}</p>
            <p><strong>åå‰:</strong> ${data.name}</p>
            <p><strong>ç™»éŒ²æ—¥:</strong> ${data.created_at}</p>
            <p><strong>ãƒ¡ãƒ¢:</strong> ${data.memo}</p>
          `;
        } else {
          resultDiv.innerHTML = "<p>è©²å½“ã™ã‚‹ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>";
        }
      } catch (error) {
        console.error("æ¤œç´¢ã‚¨ãƒ©ãƒ¼:", error);
        alert("æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ");
      }
    }

    // â• ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç™»éŒ²ï¼ˆPOSTï¼‰
    async function registerPlayer() {
      const name = document.getElementById("name").value;
      const memo = document.getElementById("memo").value;

      try {
        const res = await fetch(GAS_URL, {
          method: "POST",
          body: JSON.stringify({
            action: "addPlayer",
            name,
            memo
          }),
          headers: {
            "Content-Type": "application/json"
          }
        });

        const data = await res.json();
        document.getElementById("registerResult").innerHTML = `<p>${data.message}</p>`;
      } catch (error) {
        console.error("ç™»éŒ²ã‚¨ãƒ©ãƒ¼:", error);
        alert("ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ");
      }
    }
  </script>
</body>
</html>